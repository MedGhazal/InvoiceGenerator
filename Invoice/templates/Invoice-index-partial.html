{% load i18n %}
<h1>{% translate 'InvoiceListView' %}</h1>
{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}
<div class="invoice-list-content">
    <div class="invoice-filter-form">
        <div class="helptext">{% translate "HomeCONTROLSText" %}</div>
        <form hx-push-url="true" hx-get="{% url 'Invoice:index' %}" hx-swap="innerHTML" hx-target="main">
            {% csrf_token %}
            {{ form }}
            <input type="{% translate "submit" %}" value="{% translate "Filter" %}">
        </form>
    </div>
    {% if invoice_list %}
    <div class="invoice-list">
        <table>
            <thead>
                <tr>
                {% if managerHasMultipleInvoicers %}
                <th style="width: 300px">{% translate 'INVOICER' %}</th>
                {% endif %}
                <th style="width: 300px">{% translate 'INVOICEE' %}</th>
                <th>{% translate 'InvoiceNumber' %}</th>
                <th>{% translate 'TotalAfterVAT' %}</th>
                </tr>
            </thead>
            <tbody>
                {% for invoice in invoice_list %}
                <tr id="table-row-{{ invoice.id }}">
                    {% if managerHasMultipleInvoicers %}
                    <td style="padding-left: 5px">{{ invoice.invoicer }}</td>
                    {% endif %}
                    <td style="padding-left: 5px" helptext="{% translate 'Invoicee' %}">{{ invoice.invoicee }}</td>
                    <td helptext="{% translate 'InvoiceNumber' %}">{{ invoice.facturationDate.year }}-{{ invoice.count }}</td>
                    <td helptext="{% translate 'TotalAfterVAT' %}">{{ invoice.totalAfterVAT }}</td>
                    <td>
                        {% if invoice.wellFormed %}
                        <button 
                                helptext="{% translate 'InvoicePreviewExplanation' %}"
                                type="button"
                                hx-get="{% url 'Invoice:preview' invoice.id %}"
                                hx-push-url="true"
                                hx-swap="innerHTML"
                                hx-target="main">
                            <svg 
                                xmlns="http://www.w3.org/2000/svg" 
                                width="24" 
                                height="24" 
                                viewBox="0 0 24 24" 
                                fill="none" 
                                stroke="currentColor" 
                                stroke-width="2" 
                                stroke-linecap="round" 
                                stroke-linejoin="round" 
                                class="eye">
                                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                                <circle cx="12" cy="12" r="3"></circle>
                            </svg>
                        </button>
                        {% endif %}
                    </td>
                    <td>
                        {% if invoice.draft or invoice.estimate %}
                        <button 
                            type="button" 
                            hx-get="{% url 'Invoice:modify' invoice.id %}" 
                            hx-push-url="true" 
                            hx-swap="innerHTML" 
                            hx-target="main"
                            helptext="{% translate 'InvoiceModifyExplanation' %}">
                        <svg 
                            xmlns="http://www.w3.org/2000/svg" 
                            width="24" 
                            height="24" 
                            viewBox="0 0 24 24" 
                            fill="none" 
                            stroke="currentColor" 
                            stroke-width="2" 
                            stroke-linecap="round" 
                            stroke-linejoin="round" 
                            class="edit">
                            <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                            <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                        </svg>
                        </button>
                        {% endif %}
                    </td>
                    <td>
                        {% if invoice.wellFormed and invoice.draft %}
                        <button
                            hx-get="{% url 'Invoice:validate-invoice' invoice.id %}"
                            hx-swap="outerHTML"
                            helptext="{% translate 'ValidateInvoiceExplantion' %}"
                            hx-target="#table-row-{{ invoice.id }}">
                            <svg 
                                xmlns="http://www.w3.org/2000/svg" 
                                width="24" 
                                height="24" 
                                viewBox="0 0 24 24" 
                                fill="none" 
                                stroke="currentColor" 
                                stroke-width="2" 
                                stroke-linecap="round" 
                                stroke-linejoin="round" 
                                class="check-square">
                                <polyline points="9 11 12 14 22 4"></polyline>
                                <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path>
                            </svg>
                        </button>
                        {% endif %}
                    </td>
                    <td>
                        {% if invoice.estimate %}
                        <button 
                            hx-get="{% url 'Invoice:invoice-estimate' invoice.id %}"
                            hx-swap="innerHTML"
                            helptext="{% translate 'InvoiceEstimateExplanation' %}">
                            <svg 
                                xmlns="http://www.w3.org/2000/svg" 
                                width="24" 
                                height="24" 
                                viewBox="0 0 24 24" 
                                fill="none" 
                                stroke="currentColor" 
                                stroke-width="2" 
                                stroke-linecap="round" 
                                stroke-linejoin="round" 
                                class="slash"
                                class="check-circle">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                <polyline points="22 4 12 14.01 9 11.01"></polyline>
                            </svg>
                        </button>
                        {% endif %}
                    </td>
                    <td>
                        {% if not invoice.draft %}
                        <button
                            hx-get="{% url 'Invoice:create-creditNote' invoice.id %}"
                            hx-swap="innerHTML"
                            helptext="{% translate 'CreateCreditNoteExplanation' %}"
                            hx-target="main">
                            <svg 
                                xmlns="http://www.w3.org/2000/svg" 
                                width="24" 
                                height="24" 
                                viewBox="0 0 24 24" 
                                fill="none" 
                                stroke="currentColor" 
                                stroke-width="2" 
                                stroke-linecap="round" 
                                stroke-linejoin="round" 
                                class="corner-down-left">
                                <polyline points="9 10 4 15 9 20"></polyline>
                                <path d="M20 4v7a4 4 0 0 1-4 4H4"></path>
                            </svg>
                        </button>
                        {% endif %}
                    </td>
                    <td 
                        {% if invoice.draft %}
                        <button 
                            hx-get="{% url 'Invoice:delete-invoice' invoice.id %}"
                            hx-swap="innerHTML"
                            hx-target="main"
                            helptext="{% translate 'DeleteInvoiceButtonExplanation' %}">
                            <svg 
                                xmlns="http://www.w3.org/2000/svg" 
                                width="24" 
                                height="24" 
                                viewBox="0 0 24 24" 
                                fill="none" 
                                stroke="currentColor" 
                                stroke-width="2" 
                                stroke-linecap="round" 
                                stroke-linejoin="round" 
                                class="trash">
                                <polyline points="3 6 5 6 21 6"></polyline>
                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                <line x1="14" y1="11" x2="14" y2="17"></line>
                            </svg>
                        </button>
                        {% endif %}
                    </td>
                    <td>
                        {% if invoice.downloadable %}
                        <a href="{% url 'Invoice:download' invoice.id %}" helptext="{% translate 'DownloadInvoiceButtonExplanation' %}">
                            <svg 
                                xmlns="http://www.w3.org/2000/svg" 
                                width="24" 
                                height="24" 
                                viewBox="0 0 24 24" 
                                fill="none" 
                                stroke="currentColor" 
                                stroke-width="2" 
                                stroke-linecap="round" 
                                stroke-linejoin="round" 
                                class="download">
                                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                                <polyline points="7 10 12 15 17 10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                        </a>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
            <tfoot>
                <tr></tr>
            </tfoot>
        </table>
        <div class="invoice-list-footer">
            <button 
                class="extensive-button"
                type="button"
                hx-get="{% url 'Invoice:add-invoice' %}"
                hx-push-url="true"
                hx-swap="innerHTML"
                hx-target="main">
                <svg 
                    xmlns="http://www.w3.org/2000/svg" 
                    width="24" 
                    height="24" 
                    viewBox="0 0 24 24" 
                    fill="none" 
                    stroke="currentColor" 
                    stroke-width="2" 
                    stroke-linecap="round" 
                    stroke-linejoin="round" 
                    class="symbol invoice-plus">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <line x1="12" y1="18" x2="12" y2="12"></line><line x1="9" y1="15" x2="15" y2="15"></line>
                </svg>
                <span class="text">{% translate 'AddNewInvoice' %}</span>
        </div>
    </div>
    {% else %}
    <div class="message">{% translate 'NoInvoiceAvailableForChosenFilterOrUserHasNoInvoicers' %}</div>
    {% endif %}
</div>
